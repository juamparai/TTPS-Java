<section class="home">
	<div class="home__header">
		<div class="home__header-content">
			<div class="home__title-group">
				<h1 class="home__title">Mascotas Perdidas</h1>
				<p class="home__subtitle">Ayudá a estas mascotas a volver a casa</p>
			</div>
			<button class="home__create-btn" (click)="crearPublicacion()">
				<i class="fa-solid fa-plus"></i>
				Crear Publicación
			</button>
		</div>
	</div>

	<!-- Filtros -->
	<div class="home__filters">
		<div class="filters__container">
			<div class="filter-group">
				<label for="tipo-filter" class="filter-label">
					<i class="fa-solid fa-paw"></i>
					Tipo de Mascota
				</label>
				<select
					id="tipo-filter"
					[(ngModel)]="tipoFiltro"
					class="filter-select"
				>
					<option value="">Todos los tipos</option>
					@for (tipo of tiposMascota(); track tipo) {
						<option [value]="tipo">{{ tipo }}</option>
					}
				</select>
			</div>

			<div class="filter-group">
				<label for="provincia-filter" class="filter-label">
					<i class="fa-solid fa-map-marker-alt"></i>
					Provincia
				</label>
				<select
					id="provincia-filter"
					[(ngModel)]="provinciaIdFiltro"
					(ngModelChange)="onProvinciaChange()"
					class="filter-select"
				>
					<option value="">Todas las provincias</option>
					@for (provincia of provincias(); track provincia.id) {
						<option [value]="provincia.id">{{ provincia.nombre }}</option>
					}
				</select>
			</div>

			<div class="filter-group">
				<label for="municipio-filter" class="filter-label">
					<i class="fa-solid fa-location-dot"></i>
					Municipio
				</label>
				<select
					id="municipio-filter"
					[(ngModel)]="municipioIdFiltro"
					class="filter-select"
				>
					<option value="">Todos los municipios</option>
					@for (municipio of municipios(); track municipio.id) {
						<option [value]="municipio.id">{{ municipio.nombre }}</option>
					}
				</select>
			</div>

			<div class="filter-group">
				<label for="fecha-filter" class="filter-label">
					<i class="fa-solid fa-calendar"></i>
					Fecha
				</label>
				<select
					id="fecha-filter"
					[(ngModel)]="fechaFiltro"
					class="filter-select"
				>
					<option value="todas">Todas</option>
					<option value="hoy">Hoy</option>
					<option value="semana">Esta semana</option>
					<option value="mes">Este mes</option>
					<option value="anteriores">Anteriores (hace más de un mes)</option>
				</select>
			</div>

			<button
				class="filter-clear-btn"
				(click)="limpiarFiltros()"
				[disabled]="!tipoFiltro() && !provinciaIdFiltro() && !municipioIdFiltro() && fechaFiltro() === 'todas'"
			>
				<i class="fa-solid fa-times"></i>
				Limpiar Filtros
			</button>
		</div>
	</div>

	@if (loading()) {
		<div class="home__loading">
			<i class="fa-solid fa-spinner fa-spin"></i>
			<p>Cargando publicaciones...</p>
		</div>
	} @else if (publicacionesFiltradas().length === 0) {
		<div class="home__empty">
			<i class="fa-solid fa-paw"></i>
			<p>No hay publicaciones que coincidan con los filtros seleccionados</p>
		</div>
	} @else {
		<div class="home__grid">
			@for (publicacion of publicacionesFiltradas(); track publicacion.id) {
				<app-publicacion-card [publicacion]="publicacion"></app-publicacion-card>
			}
		</div>
	}
</section>
