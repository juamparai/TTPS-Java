<header class="navbar" role="banner">
	<div class="navbar__inner">
		<!-- Logo/Brand - clickable home button -->
		<a class="brand" routerLink="/" aria-label="Ir al inicio">
			<img class="brand__logo" src="/favicon.svg" alt="Logo" />
			<div class="brand__text">
				<span class="brand__title">¿Dónde estás?</span>
				<span class="brand__subtitle">Volvé a casa</span>
			</div>
		</a>

		<!-- Desktop navigation -->
		<nav class="actions actions--desktop" aria-label="Acciones">
			@if (user() && isAdmin()) {
				<a class="btn btn--ghost" routerLink="/admin/usuarios" routerLinkActive="is-active">Usuarios</a>
				<a class="btn btn--ghost" routerLink="/admin/mascotas" routerLinkActive="is-active">Mascotas</a>
			}
			@if (user()) {
				<div class="user-menu">
					<button
						class="user-chip user-chip--clickable"
						type="button"
						(click)="toggleDropdown()"
						[attr.aria-expanded]="dropdownOpen()"
						aria-haspopup="true"
						aria-label="Menú de usuario">
						{{ displayName() }}
						<span class="chevron" [class.chevron--open]="dropdownOpen()">
							<i class="fa-solid fa-chevron-down"></i>
						</span>
					</button>

					@if (dropdownOpen()) {
						<div class="dropdown" role="menu">
									@if (isAdmin()) {
										<a class="dropdown__item" routerLink="/admin/usuarios" (click)="closeDropdown()">
											<span class="dropdown__icon"><i class="fa-solid fa-users"></i></span>
											Listado de Usuarios
										</a>
										<a class="dropdown__item" routerLink="/admin/mascotas" (click)="closeDropdown()">
											<span class="dropdown__icon"><i class="fa-solid fa-paw"></i></span>
											Listado de Mascotas
										</a>
										<div class="dropdown__divider"></div>
									}
							<button
								class="dropdown__item"
								type="button"
								(click)="goToProfile()"
								role="menuitem">
								<span class="dropdown__icon">
									<i class="fa-solid fa-user"></i>
								</span>
								Mi perfil
							</button>
							<button
								class="dropdown__item dropdown__item--danger"
								type="button"
								(click)="logout()"
								role="menuitem">
								<span class="dropdown__icon">
									<i class="fa-solid fa-right-from-bracket"></i>
								</span>
								Cerrar sesión
							</button>
						</div>
					}
				</div>
			} @else {
				<a class="btn" routerLink="/login" routerLinkActive="is-active">Iniciar sesión</a>
				<a class="btn btn--ghost" routerLink="/registro" routerLinkActive="is-active">Registrarse</a>
			}
		</nav>

		<!-- Mobile user menu icon -->
		<div class="user-menu user-menu--mobile">
			@if (user()) {
				<button
					class="icon-btn user-icon-btn"
					type="button"
					(click)="toggleDropdown()"
					[attr.aria-expanded]="dropdownOpen()"
					aria-haspopup="true"
					aria-label="Menú de usuario">
					<i class="fa-solid fa-user"></i>
				</button>

				@if (dropdownOpen()) {
					<div class="dropdown dropdown--mobile" role="menu">
						<div class="dropdown__user-header">
							<i class="fa-solid fa-user-circle"></i>
							<span>{{ displayName() }}</span>
						</div>
							@if (isAdmin()) {
								<a class="dropdown__item" routerLink="/admin/usuarios" (click)="closeDropdown()">
									<span class="dropdown__icon"><i class="fa-solid fa-users"></i></span>
									Listado de Usuarios
								</a>
								<a class="dropdown__item" routerLink="/admin/mascotas" (click)="closeDropdown()">
									<span class="dropdown__icon"><i class="fa-solid fa-paw"></i></span>
									Listado de Mascotas
								</a>
								<div class="dropdown__divider"></div>
							}
						<div class="dropdown__divider"></div>
						<button
							class="dropdown__item"
							type="button"
							(click)="goToProfile()"
							role="menuitem">
							<span class="dropdown__icon">
								<i class="fa-solid fa-user"></i>
							</span>
							Mi perfil
						</button>
						<button
							class="dropdown__item dropdown__item--danger"
							type="button"
							(click)="logout()"
							role="menuitem">
							<span class="dropdown__icon">
								<i class="fa-solid fa-right-from-bracket"></i>
							</span>
							Cerrar sesión
						</button>
					</div>
				}
			} @else {
				<button
					class="icon-btn user-icon-btn"
					type="button"
					(click)="toggleDropdown()"
					[attr.aria-expanded]="dropdownOpen()"
					aria-haspopup="true"
					aria-label="Menú de navegación">
					<i class="fa-solid fa-ellipsis-vertical"></i>
				</button>

				@if (dropdownOpen()) {
					<div class="dropdown dropdown--mobile" role="menu">
						<a
							class="dropdown__item"
							routerLink="/login"
							(click)="closeDropdown()">
							<span class="dropdown__icon">
								<i class="fa-solid fa-right-to-bracket"></i>
							</span>
							Iniciar sesión
						</a>
						<a
							class="dropdown__item"
							routerLink="/registro"
							(click)="closeDropdown()">
							<span class="dropdown__icon">
								<i class="fa-solid fa-user-plus"></i>
							</span>
							Registrarse
						</a>
					</div>
				}
			}
		</div>
	</div>
</header>
