<div class="perfil-container">
  <!-- Sección de información del usuario -->
  <div class="perfil-header">
    <div class="perfil-avatar">
      <div class="avatar-circle">
        {{ iniciales }}
      </div>
    </div>
    <div class="perfil-info">
      <h1 class="perfil-nombre">{{ nombreCompleto }}</h1>
      @if (user()?.email) {
        <p class="perfil-email">{{ user()?.email }}</p>
      }
      @if (user()?.telefono) {
        <p class="perfil-telefono">
          <i class="icon-phone"></i> {{ user()?.telefono }}
        </p>
      }
      @if (user()?.puntos !== undefined) {
        <p class="perfil-puntos">
          <span class="puntos-badge">⭐ {{ user()?.puntos }} puntos</span>
        </p>
      }
    </div>
    <div class="perfil-actions">
      <button class="btn-editar" type="button" (click)="editarPerfil()">
        Editar Perfil
      </button>
    </div>
  </div>

  <!-- Sección de mascotas -->
  <div class="mascotas-section">
    <div class="mascotas-header">
      <h2 class="section-title">Mis Mascotas</h2>
      <button class="btn-agregar" type="button" (click)="agregarMascota()">
        + Agregar Mascota
      </button>
    </div>

    @if (loading()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Cargando mascotas...</p>
      </div>
    } @else if (error()) {
      <div class="error-state">
        <p class="error-message">{{ error() }}</p>
      </div>
    } @else if (mascotas().length === 0) {
      <div class="empty-state">
        <svg class="empty-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2Z" fill="currentColor"/>
          <path d="M16.5 3C15.4 3 14.5 3.9 14.5 5C14.5 6.1 15.4 7 16.5 7C17.6 7 18.5 6.1 18.5 5C18.5 3.9 17.6 3 16.5 3Z" fill="currentColor"/>
          <path d="M7.5 3C6.4 3 5.5 3.9 5.5 5C5.5 6.1 6.4 7 7.5 7C8.6 7 9.5 6.1 9.5 5C9.5 3.9 8.6 3 7.5 3Z" fill="currentColor"/>
          <path d="M12 8C8.69 8 6 10.69 6 14C6 17.31 8.69 20 12 20C15.31 20 18 17.31 18 14C18 10.69 15.31 8 12 8ZM12 18C9.79 18 8 16.21 8 14C8 11.79 9.79 10 12 10C14.21 10 16 11.79 16 14C16 16.21 14.21 18 12 18Z" fill="currentColor"/>
          <path d="M10.5 13C10.5 13.8284 9.82843 14.5 9 14.5C8.17157 14.5 7.5 13.8284 7.5 13C7.5 12.1716 8.17157 11.5 9 11.5C9.82843 11.5 10.5 12.1716 10.5 13Z" fill="currentColor"/>
          <path d="M16.5 13C16.5 13.8284 15.8284 14.5 15 14.5C14.1716 14.5 13.5 13.8284 13.5 13C13.5 12.1716 14.1716 11.5 15 11.5C15.8284 11.5 16.5 12.1716 16.5 13Z" fill="currentColor"/>
        </svg>
        <h3>No tienes mascotas registradas</h3>
        <p>Agrega tu primera mascota para comenzar a crear publicaciones</p>
        <button class="btn-primary" type="button" (click)="agregarMascota()">
          Agregar mi primera mascota
        </button>
      </div>
    } @else {
      <div class="carousel-container">
        <button
          class="carousel-btn carousel-btn--prev"
          type="button"
          (click)="prevMascotas()"
          [disabled]="!canPrevMascotas"
          aria-label="Anterior">
          <i class="fa-solid fa-chevron-left"></i>
        </button>

        <div class="mascotas-carousel">
          @for (mascota of mascotasVisible; track mascota.id) {
            <app-mascota-card [mascota]="mascota" [showEditButton]="true" />
          }
        </div>

        <button
          class="carousel-btn carousel-btn--next"
          type="button"
          (click)="nextMascotas()"
          [disabled]="!canNextMascotas"
          aria-label="Siguiente">
          <i class="fa-solid fa-chevron-right"></i>
        </button>
      </div>
    }
  </div>

  <!-- Sección de publicaciones -->
  <div class="publicaciones-section">
    <div class="publicaciones-header">
      <h2 class="section-title">Mis Publicaciones</h2>
    </div>

    @if (loadingPublicaciones()) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Cargando publicaciones...</p>
      </div>
    } @else if (errorPublicaciones()) {
      <div class="error-state">
        <p class="error-message">{{ errorPublicaciones() }}</p>
      </div>
    } @else if (publicaciones().length === 0) {
      <div class="empty-state">
        <svg class="empty-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z" fill="currentColor"/>
          <circle cx="12" cy="15" r="1" fill="currentColor"/>
        </svg>
        <h3>No tienes publicaciones realizadas</h3>
        <p>Crea una publicación para reportar una mascota perdida</p>
      </div>
    } @else {
      <div class="carousel-container">
        <button
          class="carousel-btn carousel-btn--prev"
          type="button"
          (click)="prevPublicaciones()"
          [disabled]="!canPrevPublicaciones"
          aria-label="Anterior">
          <i class="fa-solid fa-chevron-left"></i>
        </button>

        <div class="publicaciones-carousel">
          @for (publicacion of publicacionesVisible; track publicacion.id) {
            <app-publicacion-card [publicacion]="publicacion" />
          }
        </div>

        <button
          class="carousel-btn carousel-btn--next"
          type="button"
          (click)="nextPublicaciones()"
          [disabled]="!canNextPublicaciones"
          aria-label="Siguiente">
          <i class="fa-solid fa-chevron-right"></i>
        </button>
      </div>
    }
  </div>
</div>
