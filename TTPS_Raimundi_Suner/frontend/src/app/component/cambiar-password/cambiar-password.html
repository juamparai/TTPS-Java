<main class="page">
  <section class="card" aria-label="Cambiar Contraseña">
    <h1 class="title">Cambiar Contraseña</h1>

    <form class="form" (ngSubmit)="submit()" [formGroup]="form">
      <label class="field">
        <span class="label">Contraseña Actual</span>
        <input
          class="input"
          type="password"
          autocomplete="current-password"
          placeholder="Ingresá tu contraseña actual"
          formControlName="currentPassword"
        />
        @if ((submitted || form.controls.currentPassword.touched) && form.controls.currentPassword.invalid) {
          @if (form.controls.currentPassword.errors?.['server']) {
            <span class="hint error-hint">{{ form.controls.currentPassword.errors?.['server'] }}</span>
          }
          @if (form.controls.currentPassword.errors?.['required']) {
            <span class="hint error-hint">Campo requerido</span>
          }
        }
      </label>

      <label class="field">
        <span class="label">Nueva Contraseña</span>
        <input
          class="input"
          type="password"
          autocomplete="new-password"
          placeholder="Mínimo 7 caracteres"
          formControlName="newPassword"
        />
        @if ((submitted || form.controls.newPassword.touched) && form.controls.newPassword.invalid) {
          @if (form.controls.newPassword.errors?.['server']) {
            <span class="hint error-hint">{{ form.controls.newPassword.errors?.['server'] }}</span>
          }
          @if (form.controls.newPassword.errors?.['required']) {
            <span class="hint error-hint">Campo requerido</span>
          }
          @if (form.controls.newPassword.errors?.['minlength']) {
            <span class="hint error-hint">Debe tener más de 6 caracteres</span>
          }
        }
      </label>

      <label class="field">
        <span class="label">Repetir Nueva Contraseña</span>
        <input
          class="input"
          type="password"
          autocomplete="new-password"
          placeholder="Ingresá la misma contraseña"
          formControlName="repeatPassword"
        />
        @if ((submitted || form.controls.repeatPassword.touched) && form.controls.repeatPassword.invalid) {
          @if (form.controls.repeatPassword.errors?.['required']) {
            <span class="hint error-hint">Campo requerido</span>
          }
        }
        @if ((submitted || form.controls.repeatPassword.touched) && form.errors?.['passwordsMismatch'] && form.controls.repeatPassword.value !== '') {
          <span class="hint error-hint">Las contraseñas no coinciden</span>
        }
      </label>

      @if (errorMsg) {
        <p class="error">{{ errorMsg }}</p>
      }

      <div class="actions">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancelar()"
        >
          Cancelar
        </button>
        <button
          type="submit"
          class="btn btn-primary"
        >
          Cambiar Contraseña
        </button>
      </div>
    </form>
  </section>
</main>
